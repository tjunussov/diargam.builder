
function CbsiMantaRay(){var self=this;var $svnid="$Id: MantaRay.js 133470 2010-12-14 18:22:05Z monicak $";var $mantarev="4.1.2";var $skipBehavioral;var $skipBeacon;var $cookieMaxLen=2000;var $cookieDelimiter="&";var $isPartner=false;var adDivs=new Array();var STATIC_PAGESTATE_OBJ=new Object();var req;var MAX_DEFAD_WAIT=2000;var defAdLock=null;var GLOBAL_AD_PARAMS={};var MAC_PROXY_URL;var DVAR_SESSION;var DVAR_FIRSTPAGE;var USER_MAC_PARAM_MAP={CAT:"NCAT"};var waitTime=5*1000;var bkResults=[];var scriptObjBeacon=null;var getPort=function(){var scripts=document.getElementsByTagName("script");var scriptURL=scripts[scripts.length-1].src;if(scriptURL.match("^http(s)?://[^:]+:(\\d+)")){return RegExp.$2}return""};var PORT=getPort();this.registerAdGlobals=function(globalAdObj){if(globalAdObj){GLOBAL_AD_PARAMS=globalAdObj;setIsPartner(globalAdObj)}};this.setMacProxy=function(proxyURL){if(proxyURL){MAC_PROXY_URL=proxyURL}};var isPartner=function(){return($isPartner==true)};var setIsPartner=function(adObj){if("NO".toLowerCase()=="yes"){$isPartner=true}else{for(var param in adObj){if(!adObj.hasOwnProperty(param)){continue}if(param.toLowerCase()=="partner"&&adObj[param]){$isPartner=true}}}};var getL2Domain=function(){return isPartner()?"com.com":"techrepublic.com"};var getBrowserLanguage=function(){var language="unk";if(navigator.userLanguage){language=navigator.userLanguage}else{if(navigator.language){language=navigator.language}}return language};var runSiteFunctions=function(adObj){var session=setSessionCookie;var firstPage=setFirstPageCookie;var site=parseInt(adObj.SITE);switch(site){case 90:combineParams(adObj,session(site));break;case 103:combineParams(adObj,session(site));break;case 189:combineParams(adObj,firstPage());break;case 190:combineParams(adObj,firstPage());break;default:}switch(site){case 175:break;default:combineParams(adObj,testCookies())}};var setSessionCookie=function(site){if(DVAR_SESSION){return DVAR_SESSION}var pick=getCookieValue("MAD_SESSION");if(!pick){var cat=["a","b","c","d","e","f"];pick=cat[Math.floor(Math.random()*cat.length)];document.cookie=("MAD_SESSION="+pick+";domain="+getL2Domain()+";path=/")}DVAR_SESSION={DVAR_SESSION:pick};return DVAR_SESSION};var testCookies=function(){if(window.cbsiMadsCookiesOn){return window.cbsiMadsCookiesOn}var madTest=getCookieValue("MADTEST");if(madTest=="1"){window.cbsiMadsCookiesOn={cookiesOn:"1"}}else{var expiration=86400000;setCookie("MADTEST","1",expiration);var madTest=getCookieValue("MADTEST");if(madTest=="1"){window.cbsiMadsCookiesOn={cookiesOn:"1"}}else{window.cbsiMadsCookiesOn={cookiesOn:"0"}}}if(debug_mode()){alert("cookiesOn="+window.cbsiMadsCookiesOn.cookiesOn)}return window.cbsiMadsCookiesOn};function setFirstPageCookie(){if(DVAR_FIRSTPAGE){return DVAR_FIRSTPAGE}var firstPage=getCookieValue("MAD_FIRSTPAGE");if(firstPage==null){firstPage=1;document.cookie=("MAD_FIRSTPAGE="+firstPage+";domain="+getL2Domain()+";path=/")}else{if(firstPage==1){firstPage=0;document.cookie=("MAD_FIRSTPAGE="+firstPage+";domain="+getL2Domain()+";path=/")}}DVAR_FIRSTPAGE={DVAR_FIRSTPAGE:firstPage};return DVAR_FIRSTPAGE}this.setWaitTime=function(newWaitTime){waitTime=newWaitTime*1000};this.storePageState=function(){STATIC_PAGESTATE_OBJ.STATICPAGESTATE=window.CBSI_PAGESTATE;STATIC_PAGESTATE_OBJ.USE_STATICPAGESTATE=1};function debug_mode(){return location.hash=="#mad_debug"}function staging_mode(){return location.hash=="#mad_stage"}var getCookieValue=function(ckNm){var value=null;var allCookies=document.cookie;var pos=allCookies.indexOf(ckNm);if(pos!=-1){var start=pos+ckNm.length+1;var end=allCookies.indexOf(";",start);if(end==-1){end=allCookies.length}value=allCookies.substring(start,end)}return value?value:null};function setCookie(nm,vl,exp,domain,path){if(domain){domain=domain.replace(/^\./,"");var domainArr=domain.split(".").reverse();var docDomainArr=document.domain.split(".").reverse();var matches=true;for(var i=0;i<domainArr.length;i++){if(domainArr[i].toLowerCase()!=docDomainArr[i].toLowerCase()){matches=false;break}}if(!matches){var url="http://mads."+domain;if(PORT){url+=":"+PORT}if(vl===""){vl="|";exp=-300000}url+="/sc?c="+nm+":"+vl+":."+domain;if(path=="/"){path=""}if(exp||path||parseInt(exp)===0){var expMin="";if(exp||parseInt(exp)===0){expMin=exp/60000}url+=":"+expMin;if(path){url+=":"+path}}var img=document.createElement("img");img.setAttribute("src",url);return }}else{var dm=document.domain.split(".");domain=dm[dm.length-2]+"."+dm[dm.length-1]}var ckAttr=new Array(nm+"="+vl,"domain=."+domain);if(exp||parseInt(exp)===0){var expDt=new Date(new Date().getTime()+exp);ckAttr.push("expires="+expDt.toGMTString())}if(!path){path="/"}ckAttr.push("path="+path);document.cookie=ckAttr.join(";");if(debug_mode()){alert("Final Cookie string: '"+ckAttr.join(";")+"'")}}var combineParams=function(obj1,obj2){if(obj1&&obj2){for(var param in obj2){if(obj2.hasOwnProperty(param)){obj1[param]=obj2[param]}}}};function getDateString(date){var month=(date.getMonth()+1)+"";if(1==month.length){month="0"+month}var day=date.getDate()+"";if(1==day.length){day="0"+day}return month+day}function jsAppend(script_filename){if(debug_mode()){alert("Appending file: "+script_filename)}var html_doc=document.getElementsByTagName("head")[0];var js=document.createElement("script");js.setAttribute("language","javascript");js.setAttribute("type","text/javascript");js.setAttribute("src",script_filename);html_doc.appendChild(js);return js}function imgAppend(image_filename){if(debug_mode()){alert("Appending image: "+image_filename)}var html_doc=document.getElementsByTagName("body")[0];var img=document.createElement("img");img.setAttribute("src",image_filename);img.setAttribute("width","1");img.setAttribute("height","1");img.setAttribute("border","0");if(window.addEventListener){window.addEventListener("load",function(){html_doc.appendChild(img)},false)}else{window.attachEvent("onload",function(){html_doc.appendChild(img)})}return img}this.setupAdDiv=function(divId,localAdObj){var div=document.getElementById(divId);if(!div){document.write("<div id='"+divId+"'></div>");div=document.getElementById(divId)}if(localAdObj){div.localAdObj=localAdObj;if(localAdObj.WIDTH){div.style.width=parseInt(localAdObj.WIDTH)+"px"}if(localAdObj.HEIGHT){div.style.height=parseInt(localAdObj.HEIGHT)+"px"}}div.metaAdObj=new Object();if(localAdObj.REFRESH){div.metaAdObj.refreshable=parseInt(localAdObj.REFRESH)}else{div.metaAdObj.refreshable=0}div.ClearAd=ClearAd;div.metaAdObj.isLoaded=0;adDivs[divId]=div};this.getDeferredAds=function(listOfAdsReloading){if(defAdLock&&(new Date().getTime()-defAdLock<MAX_DEFAD_WAIT)){setTimeout(self.getDeferredAds,200,listOfAdsReloading);return }defAdLock=new Date().getTime();if(!req){req=getXHR()}else{if(req.readyState!=4&&req.readyState!=0){req.abort()}}try{req.defAdLock=defAdLock}catch(e){}var adCall=getDeferredAdCallURL(listOfAdsReloading);if(!adCall){defAdLock=null;return }req.open("GET",adCall,true);req.onreadystatechange=madJSONHandler;req.send(null)};var getXHR=function(){var req;if(window.XMLHttpRequest){req=new XMLHttpRequest()}else{if(window.ActiveXObject){try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}}return req};function madJSONHandler(){if(req.readyState==4&&(req.defAdLock==defAdLock||!req.defAdLock)){if(req.status==200){var madAd=eval("({ ads: ["+req.responseText+"]})");for(var x=0;x<madAd.ads.length;x++){var phdiv;if(madAd.ads[x]&&madAd.ads[x].divId){phdiv=document.getElementById(madAd.ads[x].divId);if(!phdiv){}else{var addiv=document.createElement("div");if(madAd.ads[x].bodyText!=null){addiv.innerHTML=madAd.ads[x].bodyText}addiv.RMIFOnLoad=RMIFOnLoad;phdiv.ClearAd();phdiv.appendChild(addiv);if(!phdiv.metaAdObj){phdiv.metaAdObj=new Object()}phdiv.metaAdObj.reloadTimestamp=new Date();if(madAd.ads[x].seg_pageState!=null){self.setSegPageState(phdiv.id,madAd.ads[x].seg_pageState)}phdiv.metaAdObj.isLoaded=1;phdiv.metaAdObj.jsonfifObj=madAd.ads[x]}}}}if(req.defAdLock==defAdLock||!req.defAdLock){defAdLock=null}}}this.RMIFOnLoad=function(win,doc){var adFrame=win.frameElement;var div=adFrame.parentNode;var pldiv=adFrame.parentNode.parentNode;if(div.childNodes.length==1){var adSpan=doc.getElementById("adSpan");var adDiv=doc.getElementById("adDiv");if(adDiv){var h;var w;if(adSpan){w=adSpan.offsetWidth;if(navigator.appName=="Microsoft Internet Explorer"){h=adSpan.offsetHeight}else{h=adDiv.offsetHeight}div.overrideAdObj=new Object()}else{h=adDiv.offsetHeight;w=adDiv.offsetWidth;pldiv.style.width=w+"px";pldiv.style.height=h+"px";pldiv.overrideAdObj=new Object()}adFrame.style.width=w+"px";adFrame.style.height=h+"px"}}};function ClearAd(){RemoveChildren(this)}function RemoveChildren(obj){var iframe=null;while(obj.childNodes.length>0){var child=obj.childNodes[0];var id=child.id;if(id=="adFrame"){iframe=child;iframe.src="about:blank"}if(id){child.id=""}if(child.childNodes.length>0){RemoveChildren(child)}obj.removeChild(child)}}this.prepareRefresh=function(divName,overrideObj){var div=document.getElementById("ad_"+divName);if(!div){return }div.overrideAdObj=overrideObj};var ad_allowed=1;var allowAd=function(){ad_allowed=1};var ASYNC_AD_FILE="";this.setAdvancedAsync=function(file_loc){if(file_loc){ASYNC_AD_FILE=file_loc}};this.getAsyncAd=function(did,localAdObj){document.write("<div id='ad_"+did+"' class='madison_async_ad'></div>");var div=document.getElementById("ad_"+did);div.localAdObj=localAdObj;div.overrideAdObj=new Object;div.RMIFOnLoad=RMIFOnLoad;div.ClearAd=ClearAd;div.LoadAd=LoadAd;div.GetAdURL=GetAdURL;if(ASYNC_AD_FILE==""){if(localAdObj.WIDTH){div.style.width=localAdObj.WIDTH+"px"}if(localAdObj.HEIGHT){div.style.height=localAdObj.HEIGHT+"px"}}div.LoadAd();adDivs[adDivs.length]=div;return div};function LoadAd(){if(!this.localAdObj){return }var adObj=new Object;combineParams(adObj,GLOBAL_AD_PARAMS);combineParams(adObj,this.localAdObj);combineParams(adObj,this.overrideAdObj);this.ClearAd();var iframe=document.createElement("iframe");iframe.id="adFrame";iframe.style.width=0+"px";iframe.style.height=0+"px";iframe.allowTransparency="true";iframe.width=0+"px";iframe.height=0+"px";iframe.marginWidth=0+"px";iframe.marginHeight=0+"px";iframe.frameBorder=0;iframe.scrolling="no";if(ASYNC_AD_FILE==""){if(!adObj.WIDTH){iframe.style.width="100px";iframe.width="100px";this.style.width="100px"}else{iframe.style.width=adObj.WIDTH+"px";iframe.width=adObj.WIDTH+"px";this.style.width=adObj.WIDTH+"px"}if(!adObj.HEIGHT){iframe.style.height="100px";iframe.height="100px";this.style.height="100px"}else{iframe.style.height=adObj.HEIGHT+"px";iframe.height=adObj.HEIGHT+"px";this.style.height=adObj.HEIGHT+"px"}}this.appendChild(iframe);if(ASYNC_AD_FILE==""){iframe.src=this.GetAdURL()}else{iframe.src=ASYNC_AD_FILE}}function GetAdURL(){var url;if(ASYNC_AD_FILE==""){url=self.getAdCallURL("ifc",this.localAdObj,this.overrideAdObj)}else{url=self.getAdCallURL("js",this.localAdObj,this.overrideAdObj)}return url}this.LoadAds=function(){if(ad_allowed==1){clearSessionVariables();ClearAds();setTimeout(DoLoadAds,100);ad_allowed=0;tmp=setTimeout(allowAd,waitTime)}};function ClearAds(){for(i=0;i<adDivs.length;i++){adDivs[i].ClearAd()}}var DoLoadAds=function(){for(i=0;i<adDivs.length;i++){adDivs[i].LoadAd()}};this.DivGetAdURL=function(win){var adFrame=win.frameElement;var div=adFrame.parentNode;return div.GetAdURL()};var clearSessionVariables=function(){window.CBSI_PAGESTATE=""};this.storePageStateCookie=function(domain,path,expiration){if(!domain){domain="cbs.com"}if(!path){path="/pacific"}if(!expiration){expiration=300000}var ps=window.CBSI_PAGESTATE;if(!ps){ps=""}setCookie("MAD_PAGESTATE",encodeURIComponent(ps),expiration,domain,path)};this.getAdCallURL=function(celt,localAdObj,overrideAdObj,globalAdObj){var url="";var adObj=new Object();if(!globalAdObj){globalAdObj=GLOBAL_AD_PARAMS}combineParams(adObj,globalAdObj);combineParams(adObj,localAdObj);combineParams(adObj,overrideAdObj);url+=getAdCallDomain(celt,adObj);url+=getAdCallGlobal(celt,globalAdObj);adObj=new Object();combineParams(adObj,localAdObj);combineParams(adObj,overrideAdObj);url+=getAdCallAdreq(adObj);if(url.length>2000){url=url.match(/.{0,2000}\&/)}return url};this.getAd=function(localAdObj,globalAdObj){var url=self.getAdCallURL("js",localAdObj,new Object(),globalAdObj);document.write("<script type='text/javascript' src='"+url+"'><\/script>\n")};this.cnetGetAd=function(adObj){self.getAd(adObj,new Object())};function getDeferredAdCallURL(listOfAdsReloading){var adseparator="%C";var adCall="";var adreqStr="";if(!MAC_PROXY_URL){return""}listOfAdsReloading=getLoadableAds(listOfAdsReloading);adCall+=MAC_PROXY_URL+"?";adCall+=getAdCallGlobal("jsonfif",GLOBAL_AD_PARAMS,adseparator,listOfAdsReloading);if(!listOfAdsReloading){for(var thisDiv in adDivs){if(adDivs.hasOwnProperty(thisDiv)){adreqStr+=getDeferredAdCallAdreq(adDivs[thisDiv])}}}else{for(var i=0;i<listOfAdsReloading.length;i++){if(adDivs[listOfAdsReloading[i]]){adreqStr+=getDeferredAdCallAdreq(adDivs[listOfAdsReloading[i]])}}}if(adreqStr==""){adCall=null}else{adCall+=adreqStr}if(adCall&&adCall.length>2000){adCall=adCall.match(/.{0,2000}\&/)}return adCall}var getAdCallDomain=function(celt,adObj){if(!adObj){adObj=new Object();combineParams(adObj,GLOBAL_AD_PARAMS)}setIsPartner(adObj);var domainStr="";var adsHost="mads.";var l2domain=getL2Domain();var port="";if(PORT.length>0){port=":"+PORT}if(staging_mode()||(adObj.STAGING=="1")){adsHost="madstage.";port=":8000"}else{if(adObj.AD_HOST){adsHost=adObj.AD_HOST;l2domain="";port=""}}var adClient=isPartner()?"cnet-ad":"mac-ad";domainStr+="http://"+adsHost+l2domain+port+"/"+adClient+"?";return domainStr};this.setSegPageState=function(divId,seg_pageState){if(adDivs[divId]){if(!adDivs[divId].metaAdObj){adDivs[divId].metaAdObj=new Object()}adDivs[divId].metaAdObj.seg_pageState=seg_pageState}};this.getFullPageState=function(listOfAdsReloading){var pageStateStr="&PAGESTATE=";if(STATIC_PAGESTATE_OBJ.USE_STATICPAGESTATE==1){if(STATIC_PAGESTATE_OBJ.STATICPAGESTATE){pageStateStr+=encodeURIComponent(STATIC_PAGESTATE_OBJ.STATICPAGESTATE)}}else{if(window.CBSI_PAGESTATE){pageStateStr+=encodeURIComponent(window.CBSI_PAGESTATE)}}if(!listOfAdsReloading){}else{var comb_pageStateStr="";for(var thisDiv in adDivs){if(!adDivs.hasOwnProperty(thisDiv)){continue}var found=false;for(var i=0;i<listOfAdsReloading.length;i++){if(listOfAdsReloading[i]==thisDiv){found=true;break}}if(!found){comb_pageStateStr+=adDivs[thisDiv].metaAdObj.seg_pageState+","}}if(comb_pageStateStr!=""){pageStateStr+="&COMB_PAGESTATE="+comb_pageStateStr}}return pageStateStr};var getAdCallGlobal=function(celt,adObj,adseparator,listOfAdsReloading){var globalStr="";if(!adObj){adObj=new Object();combineParams(adObj,GLOBAL_AD_PARAMS)}runSiteFunctions(adObj);adObj.DVAR_INSTLANG=getBrowserLanguage();if(adseparator){globalStr+="META&ADSEPARATOR=%2C&"}globalStr+="GLOBAL";globalStr+="&CLIENT:ID=SJS";globalStr+="&CELT="+celt;if(celt=="jsonfif"&&MAC_PROXY_URL){globalStr+="&MAC_PROXY="+MAC_PROXY_URL}globalStr+=self.getFullPageState(listOfAdsReloading);var anon_id=getCookieValue("XCLGFbrowser");if(anon_id){adObj["COOKIE:ANON_ID"]=anon_id}for(var param in adObj){if(!adObj.hasOwnProperty(param)){continue}var paramValue=adObj[param];if(USER_MAC_PARAM_MAP[param]){param=USER_MAC_PARAM_MAP[param]}if(param!="STAGING"&&param!="AD_HOST"){globalStr+="&"+encodeURIComponent(param)+"="+encodeURIComponent(paramValue)}}var referer="";if(window.location.protocol.match(/https:/i)){referer="&referer="+encodeURIComponent(window.location.href)}var irefer_host="";if(document.referrer&&document.referrer.length>0){var domainAndURI=document.referrer.replace(/^[^\/]+:\/\//,"");var domain=domainAndURI.replace(/[^\w\-\.].*$/,"");var l2=domain.match(/[^\.]+\.\w{2,4}$/);if(l2){irefer_host="&IREFER_HOST="+encodeURIComponent(l2)}}var randNum=Math.floor(Math.random()*100000000);globalStr+="&x-cb="+randNum+referer+irefer_host;return globalStr};var getAdCallAdreq=function(localAdObj,overrideAdObj){var adreqStr="&ADREQ";var adObj=new Object;combineParams(adObj,localAdObj);combineParams(adObj,overrideAdObj);runSiteFunctions(adObj);for(var param in adObj){if(!adObj.hasOwnProperty(param)){continue}var paramValue=adObj[param];if(USER_MAC_PARAM_MAP[param]){param=USER_MAC_PARAM_MAP[param]}if(param!="STAGING"&&param!="AD_HOST"&&param!="REFRESH"){adreqStr+="&"+encodeURIComponent(param)+"="+encodeURIComponent(paramValue)}}if(adreqStr=="&ADREQ"){adreqStr=""}return adreqStr};var getDeferredAdCallAdreq=function(div){if(isLoadable(div)){var adreq=getAdCallAdreq(div.localAdObj,div.overrideAdObj);adreq+="&divId="+div.getAttribute("id");return adreq}return""};var isLoadable=function(div){var metadata=div.metaAdObj;if(!metadata){return false}return(!metadata.reloadTimestamp||(metadata.refreshable==1&&(new Date().getTime()-metadata.reloadTimestamp.getTime()>=waitTime))||(metadata.refreshable==0&&metadata.isLoaded==0))};var getLoadableAds=function(listOfAdsReloading){var loadableAds=new Array();if(!listOfAdsReloading){for(var divId in adDivs){if(adDivs.hasOwnProperty(divId)&&isLoadable(adDivs[divId])){loadableAds.push(divId)}}}else{for(var i=0;i<listOfAdsReloading.length;i++){var divId=listOfAdsReloading[i];if(adDivs.hasOwnProperty(divId)&&isLoadable(adDivs[divId])){loadableAds.push(divId)}}}return loadableAds};function loadASI(){if(debug_mode()){alert("In loadASI() function")}if(typeof rsinetsegs=="undefined"){var js=jsAppend("http://js.revsci.net/gateway/gw.js?csid=K05540");js.onload=prepASI;js.onreadystatechange=function(){if(this.readyState==="loaded"||this.readyState==="complete"){prepASI()}}}}function prepASI(){var adObj=GLOBAL_AD_PARAMS;var paraml;for(var param in adObj){if(!adObj.hasOwnProperty(param)){continue}var paramValue=adObj[param];paraml=param.toLowerCase();if(paraml=="ncat"||paraml=="site"||paraml=="ptype"||paraml=="context"||paraml=="os"){K05540.DM_addEncToLoc(paraml,paramValue)}}K05540.DM_tag()}function loadBK(){if(debug_mode()){alert("In loadBK() function")}var js=jsAppend("http://www.bkrtx.com/js/bk-static.js");js.onload=callBK;js.onreadystatechange=function(){if(this.readyState==="loaded"||this.readyState==="complete"){callBK()}}}function callBK(){var adObj=GLOBAL_AD_PARAMS;var paraml;var bkSiteId=0;var cbs2bkMap={23:3316,252:3317,11:3318,2:3319,139:3320,1:3321,7:3322,102:3323,9:3324,3:3325,105:3326,109:3327,4:3328,53:3329,162:3330,8:3331,164:3332,163:3333,45:3334,103:3335,90:3336,101:3337,6:3338,19:3339,21:3340,50:3341,175:3344,177:3345,185:3346,189:3348};bkSiteId=cbs2bkMap[adObj.SITE]||2834;if(debug_mode()){alert("bkSiteId is: "+bkSiteId)}for(var param in adObj){if(!adObj.hasOwnProperty(param)){continue}var paramValue=adObj[param];paraml=param.toLowerCase();if(paraml in {ncat:1,site:1,ptype:1,gameid:1,mfg:1,cid:1,attr:1,carrier:1,os:1}){bk_addPageCtx(paraml,paramValue);if(debug_mode()){alert("callBK(): Adding hint: "+paraml+" value:"+paramValue)}}}bk_doCallbackTag(bkSiteId,"cbsiPrepBK",false,true)}this.prepBK=function(bk_results){for(i=0;i<bk_results.campaigns.length;i++){var cid=parseInt(bk_results.campaigns[i].campaign);bkResults.push(cid)}updateMADUCATCookie()};this.adBehavioralSetup=function(){if(debug_mode()){alert("adBehavioralSetup() called")}getAdBeacon()};function getAdBeacon(){if(debug_mode()){alert("getAdBeacon() called")}if(!$skipBeacon){$skipBeacon=1;var madTrackBeaconPercent=1;var randomNumber=Math.floor(Math.random()*100+1);var adObj=new Object();combineParams(adObj,GLOBAL_AD_PARAMS);var beaconadObj=new Object();beaconadObj.beacon="1";if(debug_mode()){alert("RandomNum: "+randomNumber)}if(randomNumber<=madTrackBeaconPercent){var trackBeacon="";trackBeacon+="http://adlog.com.com";trackBeacon+="/adlog/i/r=7807&sg=355140&h=cn&p=2&l=en_US";trackBeacon+="&t=-1&x-rnd="+Math.floor(Math.random()*100000+1);trackBeacon+="&o="+((adObj.NCAT==null)?"1:":adObj.NCAT);trackBeacon+="&b="+((adObj.BRAND==null)?"":adObj.BRAND);trackBeacon+="&site="+((adObj.SITE==null)?"":adObj.SITE);trackBeacon+="&ptype="+((adObj.PTYPE==null)?"":adObj.PTYPE);trackBeacon+="&pid="+((adObj.PID==null)?"":adObj.PID);trackBeacon+="&cid="+((adObj.CID==null)?"":adObj.CID);if(adObj.DVAR_MFG||adObj.DVAR_SELECTTAG){var dvarString;if(adObj.DVAR_MFG){dvarString="dvar_mfg="+adObj.DVAR_MFG;if(adObj.DVAR_SELECTTAG){dvarString+="#"}}if(adObj.DVAR_SELECTTAG){dvarString+="dvar_selecttag="+adObj.DVAR_SELECTTAG}trackBeacon+="&dvar="+encodeURIComponent(encodeURIComponent(dvarString))}trackBeacon+="/http://i.i.com.com/cnwk.1d/Ads/common/dotclear.gif";var trackImg=imgAppend(trackBeacon)}var url=self.getAdCallURL("js",beaconadObj);scriptObjBeacon=jsAppend(url)}}this.getAdBehavioral=function(){if(debug_mode()){alert("getAdBehavioral() called")}loadASI();loadBK()};function updateMADUCATCookie(){if(debug_mode()){alert("In updateMADUCATCookie() function")}if(!$skipBehavioral){$skipBehavioral=1;if(typeof bkResults!="undefined"&&bkResults.length>0){var version=1;var delimiter=$cookieDelimiter;var expiration=2592000000;var today=new Date();var cookie=version;cookie+=delimiter;cookie+=getDateString(today);for(var i=0;i<bkResults.length;i++){cookie=cookie+$cookieDelimiter+"BK"+bkResults[i]}if(debug_mode()){alert("new cookie calculated: "+cookie)}setCookie("MADUCAT",cookie,expiration)}else{if(debug_mode()){alert("Results are empty.  Cookie unchanged.")}}}}}if(!window.cbsiMantaRay){window.cbsiMantaRay=new CbsiMantaRay();var cbsiGetAd=cbsiMantaRay.getAd;var cnetGetAd=cbsiMantaRay.cnetGetAd;var cbsiRegisterAdGlobals=cbsiMantaRay.registerAdGlobals;var cbsiAdBehavioral=cbsiMantaRay.getAdBehavioral;var cbsiAdBehavioralSetup=cbsiMantaRay.adBehavioralSetup;var cbsiSetWaitTime=cbsiMantaRay.setWaitTime;var cbsiStorePageStateCookie=cbsiMantaRay.storePageStateCookie;var cbsiSetMacProxy=cbsiMantaRay.setMacProxy;var cbsiGetDeferredAds=cbsiMantaRay.getDeferredAds;var cbsiSetupAdDiv=cbsiMantaRay.setupAdDiv;var cbsiPrepareRefresh=cbsiMantaRay.prepareRefresh;var RMIFOnLoad=cbsiMantaRay.RMIFOnLoad;var cbsiStorePageState=cbsiMantaRay.storePageState;var cbsiSetAdvancedAsync=cbsiMantaRay.setAdvancedAsync;var cbsiGetAsyncAd=cbsiMantaRay.getAsyncAd;var cbsiRefreshAds=cbsiMantaRay.LoadAds;var cbsiDivGetAdURL=cbsiMantaRay.DivGetAdURL;var cbsiPrepBK=cbsiMantaRay.prepBK};